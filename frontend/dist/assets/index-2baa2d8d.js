import{a as r,j as e,F as q,i as G,h as K,I as Q,ap as se,aq as X,U as ne,ar as ie}from"./@mui-d49ad19a.js";import{r as c}from"./react-621b68ad.js";import{c as ve}from"./react-dom-a554dedd.js";import{N as O,L as J,B as _e}from"./react-router-dom-a07763d4.js";import{u as V}from"./react-hook-form-0809cbd4.js";import{u as T,a as I,b as E,Q as Ne,c as ye}from"./react-query-6fa84c29.js";import{a as be}from"./axios-78cd9fea.js";import{d as M,c as Se}from"./dayjs-ae8b5048.js";import{a as le,e as xe,f as Ce,g as H}from"./react-router-a9d9133a.js";import{u as k,w as W}from"./xlsx-f5126985.js";import{M as U}from"./material-react-table-57411cdb.js";import"./@babel-9193a133.js";import"./clsx-0839fdbe.js";import"./@popperjs-f3391c26.js";import"./react-transition-group-d6435cc8.js";import"./@emotion-cd5b5bf8.js";import"./hoist-non-react-statics-3f8ebaa8.js";import"./stylis-79144faa.js";import"./react-is-e5978b8b.js";import"./scheduler-765c72db.js";import"./@remix-run-734217b8.js";import"./@tanstack-21e622ef.js";import"./highlight-words-42d92bcd.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function a(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=a(i);fetch(i.href,l)}})();function Me({setMenuToggel:t,user:s,disconnect:a}){const n=()=>{t(!1)};return r("div",{className:"menu",children:[e("div",{className:"menu-close",children:e("img",{onClick:n,src:"../icones/RiCloseCircleFill.svg"})}),e("nav",{className:"menu-nav",children:r("ul",{className:"menu_nav_ul",children:[e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Émargement"})}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/mycours",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Mes cours"})}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/mystudent",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Mes élèves"})}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/myprofile",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Mon profil"})}),s.is_admin&&r(q,{children:[e("div",{className:"menu_nav_link_space"}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/teacher",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Professeurs"})}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/student",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Elèves"})}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/recap",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Recap"})}),e("li",{className:"menu_nav_li",children:e(O,{onClick:n,to:"/detail",className:({isActive:i})=>i?"menu_nav_link navlink":"menu_nav_link",children:"Detail"})})]}),e("li",{className:"menu_nav_li",children:e("a",{onClick:a,"aria-current":"page",className:"menu_nav_link",children:"Se déconnecter"})})]})}),e("p",{className:"version",children:"Version : 1.3"})]})}function Te({user:t,disconnect:s}){const[a,n]=c.useState(!1);return r("div",{className:"header",children:[r("p",{className:"header-name",children:[t.lastname," ",t.firstname]}),e("img",{onClick:()=>{n(!0)},className:"header-menu",src:"https://api.iconify.design/material-symbols:menu.svg"}),a&&e(Me,{user:t,setMenuToggel:n,disconnect:s})]})}console.log("API URL:","http://172.18.0.3:5000/");const _=be.create({baseURL:"http://172.18.0.3:5000/"}),we=t=>{_.defaults.headers.common.Authorization=t},w={newSignature:t=>_.post("/signature/",t),updateSignature:t=>_.patch("/signature/",t),deleteSignature:t=>_.delete("/signature/"+t),newStudent:t=>_.post("/student/",t),invisibleStudent:t=>_.patch("/student/invisible/"+t),visibleStudent:t=>_.patch("/student/visible/"+t),updateStudent:t=>_.patch("/student/",t),deleteStudent:t=>_.delete("/student/"+t),updatePassword:t=>_.patch("/teacher/password",t),newTeacher:t=>_.post("/teacher/",t),login:t=>_.post("/teacher/login/",t),DeleteTeacher:t=>_.delete("/teacher/item/"+t),updateTeacher:t=>_.patch("/teacher/",t),visibilityTeacher:t=>_.patch("/teacher/visibility",t),AddStudentToTeacher:t=>_.post("/teacher/link",t),DeleteStudentToTeacher:t=>_.delete("/teacher/link/"+t)},ke="/assets/logo-b13a4725.png";function De({setIsLogged:t,setUser:s}){const{register:a,handleSubmit:n,watch:i,formState:{errors:l}}=V(),o=g=>{d.mutate(g)},d=T(w.login);return d.isSuccess&&(we(d.data.headers.authorization),t(!1),s(d.data.data.user)),e(q,{children:r("div",{className:"login",children:[e("img",{className:"login_logo",src:ke,alt:""}),r("form",{className:"login_form",onSubmit:n(o),children:[d.isError?e("div",{className:"login_form_error",children:d.error.response.data.error}):null,r("div",{className:"login_form_box",children:[e("label",{children:"Email"}),e("input",{className:"login_form_input",type:"email",...a("email",{required:!0})})]}),r("div",{className:"login_form_box",children:[e("label",{children:"Password"}),e("input",{className:"login_form_input",type:"password",...a("password",{required:!0})}),l.email&&e("span",{children:"email is required"}),l.password&&e("span",{children:"password is required"})]}),e("input",{className:"login_form_submit",type:"submit"})]})]})})}const P={myStudent:()=>_.get("/student/mystudent/").then(t=>t.data),myCours:(t,s)=>_.get("/signature/mysignature/"+t+"/"+s+"/").then(a=>a.data),myCoursByStudent:(t,s,a)=>_.get("/signature/mysignature/"+t+"/"+s+"/"+a).then(n=>n.data),myCoursById:t=>_.get("/signature/"+t).then(s=>s.data),AllSignature:(t,s)=>_.get("/signature/recap/"+t+"/"+s).then(a=>a.data),getRecapSignatureByInterval:(t,s)=>_.get("/signature/recap/interval/"+t+"/"+s).then(a=>a.data),getRecapDetailByInterval:(t,s)=>_.get("/signature/detail/interval/"+t+"/"+s).then(a=>a.data),DetailSignature:(t,s)=>_.get("/signature/detail/"+t+"/"+s).then(a=>a.data),AllStudent:()=>_.get("/student").then(t=>t.data),InvisibleStudent:()=>_.get("/student/invisible").then(t=>t.data),AllTeacher:()=>_.get("/teacher").then(t=>t.data),InvisibleTeacher:()=>_.get("/teacher/visibility").then(t=>t.data),getStudentNotTeacher:t=>_.get("/student/"+t).then(s=>s.data)};M.extend(Se);function Ae({studyId:t,teacherId:s,setToggelPost:a}){var x,D,S,Y,A;const[n,i]=c.useState(""),l=()=>{a(!1)},o=M().format("YYYY-MM-DD"),d=M().format("HH:mm"),g=M().subtract(1,"hour").format("HH:mm"),{register:p,handleSubmit:m,watch:h,formState:{errors:u}}=V({defaultValues:{student_id:t,teacher_id:s,signature_date:o,start_time:g,end_time:d,shifting:!0}}),v=T(w.newSignature),f=le();return v.isSuccess&&(a(!1),f("/mycours")),v.error,r("div",{className:"post-signature",children:[e("div",{className:"post-signature-close",children:e("img",{className:"post-signature-close",onClick:l,src:"./icones/RiCloseCircleFill.svg"})}),e("div",{className:"post-signature-form-error",children:n}),r("form",{className:"post-signature-form",onSubmit:m(y=>{const R=M(y.start_time,"HH:mm");M(y.end_time,"HH:mm").isAfter(R)?v.mutate(y):i("Attention, l'heure de début est supérieure à l'heure de fin.")}),children:[e("input",{type:"hidden",...p("student_id")}),e("input",{type:"hidden",...p("teacher_id")}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Date du cours"}),e("input",{type:"date",className:((x=u.signature_date)==null?void 0:x.type)==="required"&&"red",...p("signature_date",{required:!0}),"aria-invalid":u.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Heure de début"}),e("input",{className:((D=u.start_time)==null?void 0:D.type)==="required"&&"red",type:"time",...p("start_time",{required:!0}),"aria-invalid":u.start_time?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Heure de fin"}),e("input",{className:((S=u.end_time)==null?void 0:S.type)==="required"&&"red",type:"time",...p("end_time",{required:!0}),"aria-invalid":u.end_time?"true":"false"})]}),r("div",{className:"post-signature-form-box-check",children:[r("div",{className:"post-signature-form-box",children:[e("label",{children:"Trajet ?"}),e("input",{type:"checkbox",className:((Y=u.shifting)==null?void 0:Y.type)==="required"&&"red",...p("shifting"),"aria-invalid":u.shifting?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Absent ?"}),e("input",{type:"checkbox",className:((A=u.shifting)==null?void 0:A.type)==="required"&&"red",...p("is_absent"),"aria-invalid":u.shifting?"true":"false"})]})]}),e("input",{className:"post-signature-form-submit",type:"submit"})]})]})}function Z({data:t,handelClick:s}){return r("div",{onClick:()=>{s(t)},className:"signature-name",id:t.id,children:[t.lastname," ",t.firstname]})}function L({text:t}){return e("h1",{className:"title",children:t})}function $(){return e("div",{className:"spinner",children:r("div",{className:"lds-roller",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})})}function qe({user:t}){const[s,a]=c.useState(!1),[n,i]=c.useState(""),{isLoading:l,error:o,data:d,isFetching:g}=I("repoData",P.myStudent);if(l)return e($,{});if(o)return"An error has occurred: "+o.message;const p=m=>{a(!0),i(m.id)};return r(q,{children:[r("div",{className:"signature",children:[e(L,{text:"Émargement"}),e("div",{className:"signature_wrapper",children:d.map(m=>e(Z,{data:m,handelClick:p},m.id))})]}),s&&e(Ae,{studyId:n,teacherId:t.id,setToggelPost:a})]})}function Ee({data:t,toggelHandel:s,deleteHandel:a}){const n=M(t.signature_date).format("DD/MM/YYYY");M(t.start_time).format("HH:mm");const i=()=>{s(t.id)},l=()=>{a(t.id)};return console.log(t),r("div",{className:"mycours-card",children:[r("div",{className:"mycours-card-info",children:[r("h2",{className:"mycours-card-info-title",children:[t.student_firstname," ",t.student_lastname]}),r("p",{className:"mycours-card-info-date",children:[n," ",t.start_time.slice(0,-3)," / ",t.end_time.slice(0,-3)]}),e("div",{className:"mycours-card-info-time",children:t.deci_duration}),e("img",{src:t.shifting?"../icones/car-on.svg":"../icones/car-off.svg",alt:"",className:"mycours-card-info-cars"}),e("img",{src:t.is_absent?"../icones/user-off.svg":"",alt:"",className:"mycours-card-info-cars"})]}),r("div",{className:"mycours-card-edit",children:[e("img",{onClick:l,src:"../icones/delete.svg",alt:"",className:"mycours-card-delete"}),e("img",{data:t.id,onClick:i,src:"../icones/update.svg",alt:"",className:"mycours-card-update"})]})]})}function ee({subMonth:t,addMonth:s,date:a}){return r("div",{className:"date",children:[e("img",{onClick:t,src:"https://api.iconify.design/ooui:next-rtl.svg"}),e("div",{className:"date-text",children:e("p",{className:"date-text-p",children:a})}),e("img",{onClick:s,src:"https://api.iconify.design/ooui:next-ltr.svg"})]})}function oe({signatureId:t,toggelHandelClose:s}){var x,D,S,Y,A;const[a,n]=c.useState(""),i=E(),l=T(w.updateSignature,{onSuccess:()=>i.invalidateQueries(["mycours"])}),{register:o,handleSubmit:d,formState:{errors:g},getValues:p,reset:m}=V(),{isLoading:h,error:u,data:v,isFetching:f}=I(["coursById",t],async()=>await P.myCoursById(t),{onSuccess:y=>{y.signature_date=M(y.signature_date).format("YYYY-MM-DD"),m(y)}});return h?e($,{}):u?"An error has occurred: "+u.message:r("div",{className:"post-signature",children:[e("div",{className:"post-signature-close",children:e("img",{className:"post-signature-close",onClick:s,src:"./icones/RiCloseCircleFill.svg"})}),e("div",{className:"post-signature-form-error",children:a}),r("form",{className:"post-signature-form",onSubmit:d(y=>{const R=M(y.start_time,"HH:mm");M(y.end_time,"HH:mm").isAfter(R)?(l.mutate(y),s()):n("Attention, l'heure de début est supérieure à l'heure de fin.")}),children:[e("input",{type:"hidden",...o("student_id")}),e("input",{type:"hidden",...o("teacher_id")}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Date du cours"}),e("input",{type:"date",className:((x=g.signature_date)==null?void 0:x.type)==="required"&&"red",...o("signature_date",{required:!0}),"aria-invalid":g.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Heure de début"}),e("input",{className:((D=g.start_time)==null?void 0:D.type)==="required"&&"red",type:"time",...o("start_time",{required:!0}),"aria-invalid":g.start_time?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Heure de fin"}),e("input",{className:((S=g.end_time)==null?void 0:S.type)==="required"&&"red",type:"time",...o("end_time",{required:!0}),"aria-invalid":g.end_time?"true":"false"})]}),r("div",{className:"post-signature-form-box-check",children:[r("div",{className:"post-signature-form-box",children:[e("label",{children:"Trajet ?"}),e("input",{type:"checkbox",className:((Y=g.shifting)==null?void 0:Y.type)==="required"&&"red",...o("shifting"),"aria-invalid":g.shifting?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Absent ?"}),e("input",{type:"checkbox",className:((A=g.shifting)==null?void 0:A.type)==="required"&&"red",...o("is_absent"),"aria-invalid":g.shifting?"true":"false"})]})]}),e("input",{className:"post-signature-form-submit",type:"submit"})]})]})}function de({deleteHandelClose:t,id:s}){const a=E(),n=T(w.deleteSignature,{onSuccess:()=>a.invalidateQueries(["mycours"])});return e("div",{className:"delete",children:r("div",{className:"delete_signature",children:[e("div",{className:"delete_signature_header",children:"Voulez-vous supprimer ce cours ?"}),r("div",{className:"delete_signature_footer",children:[e("div",{onClick:()=>{n.mutate(s),t()},className:"delete_signature_footer_box",children:"OUI"}),e("div",{onClick:t,className:"delete_signature_footer_box",children:"NON"})]})]})})}M.locale("fr");function ae(){let{id:t}=xe(),s="";t&&(s=t);const[a,n]=c.useState(M()),[i,l]=c.useState(!1),[o,d]=c.useState(""),[g,p]=c.useState(!1),[m,h]=c.useState(""),u=N=>{h(N),p(!0)},v=()=>{p(!1)},f=N=>{l(!0),d(N)},b=N=>{l(!1)},{isLoading:x,error:D,data:S,isPreviousData:Y}=I(["mycours",Number(a.format("M")),Number(a.format("YYYY")),s],async()=>await P.myCoursByStudent(Number(a.format("M")),Number(a.format("YYYY")),s),{refetchOnWindowFocus:!0,staleTime:0,cacheTime:0,refetchInterval:0});if(x)return e($,{});if(D)return"An error has occurred: "+D.message;const A=()=>{n(a.add(1,"month"))},y=()=>{n(a.add(-1,"month"))},R=()=>{const N=k.json_to_sheet(S.data),j=k.book_new();k.book_append_sheet(j,N,"Feuille1"),W(j,`Mes cours ${a.format("MMMM/YYYY")}.xlsx`)};return r(q,{children:[g&&e(de,{deleteHandelClose:v,id:m}),r("div",{className:"mycours",children:[s==""&&e(L,{text:"Mes cours"}),s!=""&&e(L,{text:"Mes éleves"}),e("div",{className:"mycour-nav",children:e(ee,{addMonth:A,subMonth:y,date:a.format("MMMM YYYY")})}),r("div",{className:"mycours-info",children:[r("p",{className:"",children:["Cours dispensés : ",S.total.nbSignature]}),r("p",{className:"",children:["Heures travaillées : ",S.total.hoursDeci]}),r("p",{className:"",children:["Nombre de trajets : ",S.total.shifting]})]}),e("div",{className:"allsignature-nav-export",onClick:R,children:"Exporter vers excel"}),e("div",{className:"mycours-warpper",children:S.data.map(N=>e(Ee,{data:N,toggelHandel:f,deleteHandel:u},N.id))})]}),i&&e(oe,{signatureId:o,toggelHandelClose:b})]})}function Ye({user:t}){c.useState(!1),c.useState("");const s=le(),{isLoading:a,error:n,data:i,isFetching:l}=I("repoData",P.myStudent);if(a)return e($,{});if(n)return"An error has occurred: "+n.message;const o=d=>{s(`/myCours/${d.id}`)};return r("div",{className:"signature",children:[e(L,{text:"Mes élèves"}),e("div",{className:"signature_wrapper",children:i.map(d=>e(Z,{data:d,handelClick:o}))})]})}function Ie({disconnect:t}){var m,h;const[s,a]=c.useState(""),n=T(w.updatePassword,{onSuccess:u=>{t()},onError:u=>{a(u.response.data.error)}}),{register:i,handleSubmit:l,formState:{errors:o},getValues:d,reset:g}=V();return r("div",{className:"profile",children:[e(L,{text:"Mon profil"}),r("form",{className:"profile-form",onSubmit:l(u=>{n.mutate(u)}),children:[r("div",{className:"profile-form-box",children:[e("label",{children:"Ancien mot de passe"}),e("input",{type:"password",className:((m=o.oldPassword)==null?void 0:m.type)==="required"&&"red",...i("oldPassword",{required:!0}),"aria-invalid":o.oldPassword?"true":"false"})]}),r("div",{className:"profile-form-box",children:[e("label",{children:"Nouveau mot de passe"}),e("input",{type:"password",className:((h=o.newPassword)==null?void 0:h.type)==="required"&&"red",...i("newPassword",{required:!0}),"aria-invalid":o.newPassword?"true":"false"})]}),s,e("input",{className:"profile-form-submit",type:"submit"})]})]})}const Pe=()=>{const{register:t,handleSubmit:s,formState:{errors:a}}=V(),[n,i]=c.useState({start:null,end:null}),[l,o]=c.useState(!1),d=async({queryKey:u})=>{const[v,f,b]=u;return await P.getRecapSignatureByInterval(f,b)},{isLoading:g,error:p,data:m}=I(["getRecapSignatureByInterval",n.start,n.end],d,{enabled:!!n.start&&!!n.end,refetchOnWindowFocus:!1,staleTime:0,cacheTime:0,refetchInterval:0});c.useEffect(()=>{if(m&&l){const u=k.json_to_sheet(m),v=k.book_new();k.book_append_sheet(v,u,"Feuille1"),W(v,`Recap ${n.start} / ${n.end}.xlsx`),o(!1)}},[m,l,n.start,n.end]);const h=u=>{i({start:u.start,end:u.end}),o(!0)};return g?e($,{}):p?r("div",{children:["An error has occurred: ",p.message]}):e("div",{className:"RecapInvalid",children:r("form",{onSubmit:s(h),children:[r("div",{className:"RecapInvalid_form",children:[r("div",{className:"RecapInvalid_from_box",children:[e("label",{htmlFor:"start",children:"Debu: "}),e("input",{type:"date",id:"start",...t("start",{required:"Start date is required"})}),a.start&&e("p",{children:a.start.message})]}),r("div",{className:"RecapInvalid_from_box",children:[e("label",{htmlFor:"end",children:"Fin: "}),e("input",{type:"date",id:"end",...t("end",{required:"End date is required"})}),a.end&&e("p",{children:a.end.message})]})]}),e("button",{className:"RecapInvalid_from_submit",type:"submit",children:"Exporter"})]})})};M.locale("fr");function $e(){const[t,s]=c.useState(M()),[a,n]=c.useState(!1),i=c.useMemo(()=>[{accessorKey:"student",header:"L'étudiant",maxSize:30},{accessorKey:"teacher",header:"L'enseignant",size:30},{accessorKey:"intervention",header:"Nombre d'intervention",size:30},{accessorKey:"deplacement",header:"Déplacement",size:30},{accessorKey:"is_absent",header:"Absent",size:30},{accessorKey:"duration",header:"Temps total",size:30},{accessorKey:"deci_duration",header:"Temps décimal",size:30}],[]),{isLoading:l,error:o,data:d,isPreviousData:g}=I(["mycours",Number(t.format("M")),Number(t.format("YYYY"))],async()=>await P.AllSignature(Number(t.format("M")),Number(t.format("YYYY"))),{refetchOnWindowFocus:!0,staleTime:0,cacheTime:0,refetchInterval:0});if(l)return e($,{});if(o)return"An error has occurred: "+o.message;const p=()=>{s(t.add(1,"month"))},m=()=>{s(t.add(-1,"month"))},h=()=>{const v=k.json_to_sheet(d),f=k.book_new();k.book_append_sheet(f,v,"Feuille1"),W(f,`Recap ${t.format("MMMM/YYYY")}.xlsx`)},u=()=>{n(!a)};return e(q,{children:r("div",{className:"mycours",children:[e(L,{text:"Recap"}),r("div",{className:"allsignature-nav",children:[e(ee,{addMonth:p,subMonth:m,date:t.format("MMMM YYYY")}),e("div",{className:"allsignature-nav-export",onClick:u,children:"Exporter"}),a&&r("div",{className:"allsignature_toggle",children:[r("div",{className:"allsignature-nav-export",onClick:h,children:["Exporter ",t.format("MMMM YYYY")]}),e(Pe,{})]})]}),e("div",{className:"allsignature-warpper",children:e(U,{columns:i,data:d})})]})})}const Re=()=>{const{register:t,handleSubmit:s,formState:{errors:a}}=V(),[n,i]=c.useState({start:null,end:null}),[l,o]=c.useState(!1),d=async({queryKey:u})=>{const[v,f,b]=u;return await P.getRecapDetailByInterval(f,b)},{isLoading:g,error:p,data:m}=I(["getRecapDetailByInterval",n.start,n.end],d,{enabled:!!n.start&&!!n.end,refetchOnWindowFocus:!1,staleTime:0,cacheTime:0,refetchInterval:0});c.useEffect(()=>{if(m&&l){const u=k.json_to_sheet(m),v=k.book_new();k.book_append_sheet(v,u,"Feuille1"),W(v,`Recap ${n.start} / ${n.end}.xlsx`),o(!1)}},[m,l,n.start,n.end]);const h=u=>{i({start:u.start,end:u.end}),o(!0)};return g?e($,{}):p?r("div",{children:["An error has occurred: ",p.message]}):e("div",{className:"RecapInvalid",children:r("form",{onSubmit:s(h),children:[r("div",{className:"RecapInvalid_form",children:[r("div",{className:"RecapInvalid_from_box",children:[e("label",{htmlFor:"start",children:"Debu: "}),e("input",{type:"date",id:"start",...t("start",{required:"Start date is required"})}),a.start&&e("p",{children:a.start.message})]}),r("div",{className:"RecapInvalid_from_box",children:[e("label",{htmlFor:"end",children:"Fin: "}),e("input",{type:"date",id:"end",...t("end",{required:"End date is required"})}),a.end&&e("p",{children:a.end.message})]})]}),e("button",{className:"RecapInvalid_from_submit",type:"submit",children:"Exporter"})]})})};M.locale("fr");function Fe(){const[t,s]=c.useState(M()),[a,n]=c.useState(!1),[i,l]=c.useState(""),[o,d]=c.useState(!1),[g,p]=c.useState(""),[m,h]=c.useState(!1),u=c.useMemo(()=>[{accessorKey:"student",header:"l'étudiant",maxSize:30},{accessorKey:"teacher",header:"l'enseignant",size:30},{accessorKey:"signature_date",header:"date",size:30},{accessorKey:"start_time",header:"start",size:30},{accessorKey:"end_time",header:"end",size:30},{accessorKey:"duration",header:"Temps total",size:30},{accessorKey:"deci_duration",header:"Temps décimal",size:30},{accessorKey:"shifting",header:"Trajet",size:20,Cell:({cell:C})=>C.getValue()?e("img",{src:"../icones/car-on.svg",alt:"",className:"mycours-card-info-cars"}):e("img",{src:"../icones/car-off.svg",alt:"",className:"mycours-card-info-cars"})},{accessorKey:"is_absent",header:"Absent",size:20,Cell:({cell:C})=>{if(C.getValue())return e("img",{src:"../icones/user-off.svg",alt:"",className:"mycours-card-info-cars"})}}],[]),{isLoading:v,error:f,data:b,isPreviousData:x}=I(["mycours",Number(t.format("M")),Number(t.format("YYYY"))],async()=>await P.DetailSignature(Number(t.format("M")),Number(t.format("YYYY"))),{refetchOnWindowFocus:!0,staleTime:0,cacheTime:0,refetchInterval:0});if(v)return e($,{});if(f)return"An error has occurred: "+f.message;const D=()=>{s(t.add(1,"month"))},S=()=>{s(t.add(-1,"month"))},Y=()=>{const C=k.json_to_sheet(b),B=k.book_new();k.book_append_sheet(B,C,"Feuille1"),W(B,`Detail ${t.format("MMMM/YYYY")}.xlsx`)},A=()=>{h(!m)},y=C=>{n(!0),l(C.original.id)},R=C=>{n(!1)},N=C=>{d(!0),p(C.original.id)},j=()=>{d(!1)};return e(q,{children:r("div",{className:"mycours",children:[e(L,{text:"Detail"}),r("div",{className:"allsignature-nav",children:[e(ee,{addMonth:D,subMonth:S,date:t.format("MMMM YYYY")}),e("div",{className:"allsignature-nav-export",onClick:A,children:"Exporter"}),m&&r("div",{className:"allsignature_toggle",children:[r("div",{className:"allsignature-nav-export",onClick:Y,children:["Exporter ",t.format("MMMM YYYY")]}),e(Re,{})]})]}),e("div",{className:"allsignature-warpper",children:e(U,{columns:u,data:b,enableEditing:!0,renderRowActions:({row:C,table:B})=>r(G,{sx:{display:"flex",gap:"1rem"},children:[e(K,{arrow:!0,placement:"left",title:"Edit",children:e(Q,{onClick:()=>y(C),children:e(se,{})})}),e(K,{arrow:!0,placement:"right",title:"Delete",children:e(Q,{color:"error",onClick:()=>N(C),children:e(X,{})})})]})})}),a&&e(oe,{signatureId:i,toggelHandelClose:R}),o&&e(de,{deleteHandelClose:j,id:g})]})})}function z({children:t,Close:s}){return r("div",{className:"modal",children:[e("div",{className:"modal-close",children:e("img",{className:"pmodal-close",onClick:s,src:"./icones/RiCloseCircleFill.svg"})}),t]})}function He({toggelHandelClose:t}){var p,m;const s=E(),a=T(w.newStudent,{onSuccess:()=>s.invalidateQueries(["AllStudent"])}),{register:n,handleSubmit:i,formState:{errors:l},getValues:o,reset:d}=V();return r("form",{className:"post-signature-form",onSubmit:i(h=>{a.mutate(h),t()}),children:[r("div",{className:"post-signature-form-box",children:[e("label",{children:"Nom"}),e("input",{type:"text",className:((p=l.signature_date)==null?void 0:p.type)==="required"&&"red",...n("lastname",{required:!0}),"aria-invalid":l.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Prénom"}),e("input",{type:"text",className:((m=l.signature_date)==null?void 0:m.type)==="required"&&"red",...n("firstname",{required:!0}),"aria-invalid":l.signature_date?"true":"false"})]}),e("input",{type:"submit"})]})}function ce({deleteHandelClose:t,id:s}){const a=E(),n=T(w.deleteStudent,{onSuccess:()=>a.invalidateQueries(["VisibleStudent"])});return r(q,{children:[r("div",{className:"delete_signature_header",children:[e("p",{className:"alest",children:"Attention, la suppression d'un élève entraîne la suppression des émargements associés !"}),e("p",{children:"Confirmez-vous la suppression ?"})]}),r("div",{className:"delete_signature_footer",children:[e("div",{onClick:()=>{n.mutate(s),t()},className:"delete_signature_footer_box",children:"OUI"}),e("div",{onClick:t,className:"delete_signature_footer_box",children:"NON"})]})]})}function Le({toggelEditId:t,toggelHandelClose:s}){var m,h;const a=E(),n=T(w.updateStudent,{onSuccess:()=>a.invalidateQueries(["AllStudent"])}),{register:i,handleSubmit:l,formState:{errors:o},getValues:d,reset:g}=V({defaultValues:{lastname:t.lastname,firstname:t.firstname,studentId:t.id}});return r("form",{className:"post-signature-form",onSubmit:l(u=>{n.mutate(u),s()}),children:[e("input",{type:"hidden",...i("id")}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Nom"}),e("input",{type:"text",className:((m=o.signature_date)==null?void 0:m.type)==="required"&&"red",...i("lastname",{required:!0}),"aria-invalid":o.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Prénom"}),e("input",{type:"text",className:((h=o.signature_date)==null?void 0:h.type)==="required"&&"red",...i("firstname",{required:!0}),"aria-invalid":o.signature_date?"true":"false"})]}),e("input",{type:"submit"})]})}function ze(){const[t,s]=c.useState(!1),[a,n]=c.useState(!1),[i,l]=c.useState(""),[o,d]=c.useState(!1),[g,p]=c.useState(""),m=c.useMemo(()=>[{accessorKey:"lastname",header:"Nom",maxSize:30},{accessorKey:"firstname",header:"Prénom",size:30}],[]),h=E(),u=T(w.invisibleStudent,{onSuccess:()=>h.invalidateQueries(["AllStudent"])}),{isLoading:v,error:f,data:b,isPreviousData:x}=I(["AllStudent"],async()=>await P.AllStudent(),{refetchOnWindowFocus:!0});if(v)return e($,{});if(f)return"An error has occurred: "+f.message;const D=N=>{s(!0)},S=()=>{s(!1)},Y=N=>{n(!0),l(N.original)},A=N=>{n(!1)},y=()=>{d(!1)},R=N=>{u.mutate(N.original.id)};return e(q,{children:r("div",{className:"mycours",children:[e(L,{text:"Eléves"}),r("nav",{className:"mycours_nav",children:[e("div",{className:"mycours_add",onClick:D,children:"Ajouter"}),e(J,{className:"mycours_trash",to:"/student-trash",children:"Voir les étudiants masqués."})]}),e("div",{className:"allsignature-warpper",children:e(U,{columns:m,data:b,enableEditing:!0,renderRowActions:({row:N,table:j})=>r(G,{sx:{display:"flex",gap:"1rem"},children:[e(K,{arrow:!0,placement:"left",title:"Edit",children:e(Q,{onClick:()=>Y(N),children:e(se,{})})}),e(K,{arrow:!0,placement:"right",title:"Invisible",children:e(Q,{color:"error",onClick:()=>R(N),children:e(ne,{})})})]})})}),t&&e(z,{Close:S,children:e(He,{toggelHandelClose:S})}),o&&e(z,{Close:y,children:e(ce,{deleteHandelClose:y,id:g})}),a&&e(z,{Close:A,children:e(Le,{toggelEditId:i,toggelHandelClose:A})})]})})}function Ve(){const[t,s]=c.useState(!1),[a,n]=c.useState(""),i=f=>{s(!0),n(f.original.id)},l=()=>{s(!1)},o=c.useMemo(()=>[{accessorKey:"lastname",header:"Nom",maxSize:30},{accessorKey:"firstname",header:"Prénom",size:30}],[]),d=E(),g=T(w.visibleStudent,{onSuccess:()=>d.invalidateQueries(["VisibleStudent"])}),{isLoading:p,error:m,data:h,isPreviousData:u}=I(["VisibleStudent"],async()=>await P.InvisibleStudent(),{refetchOnWindowFocus:!0});if(p)return e($,{});if(m)return"An error has occurred: "+m.message;const v=f=>{g.mutate(f.original.id)};return r("div",{className:"mycours",children:[e(L,{text:"Eleves masquer"}),e(J,{className:"mycours_trash",to:"/student",children:"Voir les élèves visibles"}),e("div",{className:"allsignature-warpper",children:e(U,{columns:o,data:h,enableEditing:!0,renderRowActions:({row:f,table:b})=>r(G,{sx:{display:"flex",gap:"1rem"},children:[e(K,{arrow:!0,placement:"left",title:"Visible",children:e(Q,{onClick:()=>v(f),children:e(ie,{})})}),e(K,{arrow:!0,placement:"right",title:"Delete",children:e(Q,{color:"error",onClick:()=>i(f),children:e(X,{})})})]})})}),t&&e(z,{Close:l,children:e(ce,{deleteHandelClose:l,id:a})})]})}function Oe({data:t,handellModalDelete:s,handellModalEdit:a,handellModalAddStudent:n,handellModalDeleteStudent:i}){const l=()=>{s(t.id)},o=()=>{a(t)},d=()=>{n(t)},g=p=>{i(t,p.target.id)};return r("div",{className:"teacher_card",children:[r("div",{className:"teacher_card_head",children:[t.lastname," ",t.firstname," ",t.is_admin&&" - Admin"]}),e("div",{className:"teacher_card_info"}),e("div",{className:"teacher_card_student",children:t.students.map(p=>r("div",{className:"teacher_card_student_item",children:[e("img",{onClick:g,className:"teacher_card_student_item_supr",src:"../icones/RiCloseCircleFill.svg",id:p.id_link}),r("div",{className:"teacher_card_student_item_name",children:[p.lastname," ",p.firstname]})]}))}),e("div",{onClick:d,className:"teacher_card_student_add",children:"Ajouter un étudiant"}),r("div",{className:"teacher_card_footer",children:[e("div",{className:"teacher_card_footer_icon",children:e("img",{onClick:o,src:"../icones/update.svg",alt:"",className:"teacher_card_footer_icon-update"})}),e("div",{className:"teacher_card_footer_icon",children:e(ne,{style:{fontSize:32},className:"teacher_card_footer_icon_delete",onClick:l})})]})]})}function Ke({close:t}){var h,u,v,f,b;const[s,a]=c.useState(""),n=E(),i=T(w.newTeacher,{onSuccess:()=>{n.invalidateQueries(["AllTeacher"]),t()},onError:x=>{a(x.response.data.error)}}),{register:l,handleSubmit:o,formState:{errors:d},getValues:g,reset:p}=V();return r("form",{className:"post-signature-form",onSubmit:o(x=>{i.mutate(x)}),children:[e("div",{className:"add_teacher_error",children:s}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Nom"}),e("input",{type:"text",className:((h=d.signature_date)==null?void 0:h.type)==="required"&&"red",...l("lastname",{required:!0}),"aria-invalid":d.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Prénom"}),e("input",{type:"text",className:((u=d.signature_date)==null?void 0:u.type)==="required"&&"red",...l("firstname",{required:!0}),"aria-invalid":d.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Email"}),e("input",{type:"email",className:((v=d.signature_date)==null?void 0:v.type)==="required"&&"red",...l("email",{required:!0}),"aria-invalid":d.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Password"}),e("input",{type:"password",className:((f=d.signature_date)==null?void 0:f.type)==="required"&&"red",...l("password",{required:!0}),"aria-invalid":d.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Admin"}),e("input",{type:"checkbox",className:((b=d.signature_date)==null?void 0:b.type)==="required"&&"red",...l("isAdmin"),"aria-invalid":d.signature_date?"true":"false"})]}),e("input",{type:"submit"})]})}function ue({deleteHandelClose:t,id:s}){const[a,n]=c.useState(""),i=E(),l=T(w.DeleteTeacher,{onSuccess:()=>{i.invalidateQueries(["InvisibleTeacher"]),t()},onError:d=>{n(d.response.data.error)}});return r(q,{children:[a&&e("p",{className:"delete_http_error",children:a}),!a&&r(q,{children:[r("div",{className:"delete_signature_header",children:[e("p",{className:"alest",children:"Attention, la suppression d'un professeurs entraîne la suppression des émargements associés !"}),e("p",{children:"Confirmez-vous la suppression ?"})]}),r("div",{className:"delete_signature_footer",children:[e("div",{onClick:()=>{l.mutate(s)},className:"delete_signature_footer_box",children:"OUI"}),e("div",{onClick:t,className:"delete_signature_footer_box",children:"NON"})]})]})]})}function Qe({data:t,Close:s}){var m,h,u,v;const a=E(),n=T(w.updateTeacher,{onSuccess:()=>{a.invalidateQueries(["AllTeacher"]),s()},onError:f=>{}}),{register:i,handleSubmit:l,formState:{errors:o},getValues:d,reset:g}=V({defaultValues:{teacher_id:t.id,lastname:t.lastname,firstname:t.firstname,email:t.email,is_admin:t.is_admin}});return r("form",{className:"post-signature-form",onSubmit:l(f=>{n.mutate(f)}),children:[e("input",{type:"hidden",...i("teacher_id")}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Nom"}),e("input",{type:"text",className:((m=o.signature_date)==null?void 0:m.type)==="required"&&"red",...i("lastname",{required:!0}),"aria-invalid":o.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Prénom"}),e("input",{type:"text",className:((h=o.signature_date)==null?void 0:h.type)==="required"&&"red",...i("firstname",{required:!0}),"aria-invalid":o.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Email"}),e("input",{type:"email",className:((u=o.signature_date)==null?void 0:u.type)==="required"&&"red",...i("email",{required:!0}),"aria-invalid":o.signature_date?"true":"false"})]}),r("div",{className:"post-signature-form-box",children:[e("label",{children:"Admin"}),e("input",{type:"checkbox",className:((v=o.signature_date)==null?void 0:v.type)==="required"&&"red",...i("is_admin"),"aria-invalid":o.signature_date?"true":"false"})]}),e("input",{type:"submit"})]})}function je({teacherData:t,Close:s}){const a=E(),[n,i]=c.useState(""),l=T(w.AddStudentToTeacher,{onSuccess:()=>{a.invalidateQueries(["AllTeacher"]),a.invalidateQueries(["NotStudent"])},onError:h=>{}}),o=h=>{l.mutate({teacher_id:t.id,student_id:h.id})},{isLoading:d,error:g,data:p}=I(["NotStudent",t.id],async()=>await P.getStudentNotTeacher(t.id),{refetchOnWindowFocus:!0,staleTime:0,cacheTime:0,refetchInterval:0});if(d)return e($,{});if(g)return"An error has occurred: "+g.message;const m=(p||[]).filter(h=>(h.lastname||"").toLowerCase().includes(n.toLowerCase()));return r("div",{className:"AddStudentToTeacher",children:[r("div",{className:"AddStudentToTeacher_title",children:["Ajouter un étudiant à ",t.firstname," ",t.lastname]}),e("div",{className:"AddStudentToTeacher_search",children:e("input",{type:"text",placeholder:"Rechercher des étudiants...",value:n,onChange:h=>i(h.target.value)})}),m.length===0&&e("div",{className:"title",children:"Aucun étudiant n'est disponible."}),m.length>0&&r(q,{children:[e("div",{className:"AddStudentToTeacher_error"}),e("div",{className:"AddStudentToTeacher_wrapper",children:m.map(h=>e(Z,{data:h,handelClick:o},h.id))})]})]})}function Be({Close:t,id:s}){const[a,n]=c.useState(""),i=E(),l=T(w.DeleteStudentToTeacher,{onSuccess:()=>{i.invalidateQueries(["AllTeacher"]),t()},onError:d=>{n(d.response.data.error)}});return r(q,{children:[e("div",{className:"supr_teacher_erroe",children:a}),e("div",{className:"delete_signature_header",children:"Voulez-vous supprimer ?"}),r("div",{className:"delete_signature_footer",children:[e("div",{onClick:()=>{l.mutate(s)},className:"delete_signature_footer_box",children:"OUI"}),e("div",{onClick:t,className:"delete_signature_footer_box",children:"NON"})]})]})}function We(){const[t,s]=c.useState(!1),[a,n]=c.useState(!1),[i,l]=c.useState(""),[o,d]=c.useState(!1),[g,p]=c.useState(""),[m,h]=c.useState(!1),[u,v]=c.useState(""),[f,b]=c.useState(!1),[x,D]=c.useState(""),S=F=>{s(!0)},Y=()=>{s(!1)},A=F=>{he.mutate({id:F,visibility:!1})},y=()=>{n(!1)},R=F=>{d(!0),p(F)},N=()=>{d(!1)},j=F=>{h(!0),v(F)},C=()=>{h(!1)},B=(F,fe)=>{b(!0),D(fe)},te=()=>{b(!1)},me=E(),he=T(w.visibilityTeacher,{onSuccess:()=>me.invalidateQueries(["AllTeacher"])}),{isLoading:pe,error:re,data:ge,isPreviousData:Xe}=I(["AllTeacher"],async()=>await P.AllTeacher(),{refetchOnWindowFocus:!0});return pe?e($,{}):re?"An error has occurred: "+re.message:r("div",{className:"teacher",children:[e(L,{text:"Professeurs"}),e("div",{className:"mycours_add",onClick:S,children:"Ajouter"}),e(J,{className:"mycours_trash",to:"/teacher-trash",children:"Voir les Professeurs masqués."}),e("div",{className:"teacher-warpper",children:ge.map(F=>e(Oe,{data:F,handellModalDelete:A,handellModalEdit:R,handellModalAddStudent:j,handellModalDeleteStudent:B},F.id))}),t&&e(z,{Close:Y,children:e(Ke,{close:Y})}),a&&e(z,{Close:y,children:e(ue,{id:i,Close:y})}),o&&e(z,{Close:N,children:e(Qe,{data:g,Close:N})}),m&&e(z,{Close:C,children:e(je,{teacherData:u,Close:C})}),f&&e(z,{Close:te,children:e(Be,{Close:te,id:x})})]})}function Ue(){const[t,s]=c.useState(!1),[a,n]=c.useState(""),i=f=>{s(!0),n(f.original.id)},l=()=>{s(!1)},o=c.useMemo(()=>[{accessorKey:"lastname",header:"Nom",maxSize:30},{accessorKey:"firstname",header:"Prénom",size:30}],[]),d=E(),g=T(w.visibilityTeacher,{onSuccess:()=>d.invalidateQueries(["InvisibleTeacher"])}),{isLoading:p,error:m,data:h,isPreviousData:u}=I(["InvisibleTeacher"],async()=>await P.InvisibleTeacher(),{refetchOnWindowFocus:!0});if(p)return e($,{});if(m)return"An error has occurred: "+m.message;const v=f=>{g.mutate({id:f.original.id,visibility:!0})};return r("div",{className:"mycours",children:[e(L,{text:"Professeurs masquer"}),e(J,{className:"mycours_trash",to:"/teacher",children:"Voir les Professeurs visibles"}),e("div",{className:"allsignature-warpper",children:e(U,{columns:o,data:h,enableEditing:!0,renderRowActions:({row:f,table:b})=>r(G,{sx:{display:"flex",gap:"1rem"},children:[e(K,{arrow:!0,placement:"left",title:"Visible",children:e(Q,{onClick:()=>v(f),children:e(ie,{})})}),e(K,{arrow:!0,placement:"right",title:"Delete",children:e(Q,{color:"error",onClick:()=>i(f),children:e(X,{})})})]})})}),t&&e(z,{Close:l,children:e(ue,{deleteHandelClose:l,id:a})})]})}function Ge(){const[t,s]=c.useState(!0),[a,n]=c.useState({}),i=()=>{n({}),s(!0)};return r(q,{children:[t&&e(De,{setIsLogged:s,setUser:n}),!t&&r("div",{children:[e(Te,{user:a,disconnect:i}),e("div",{className:"main",children:r(Ce,{children:[e(H,{path:"/",element:e(qe,{user:a})}),e(H,{path:"/mycours",element:e(ae,{}),children:e(H,{path:":id",element:e(ae,{})})}),e(H,{path:"/mystudent",element:e(Ye,{user:a})}),e(H,{path:"/myprofile",element:e(Ie,{disconnect:i})}),a.is_admin&&r(q,{children:[e(H,{path:"/teacher",element:e(We,{})}),e(H,{path:"/student",element:e(ze,{})}),e(H,{path:"/student-trash",element:e(Ve,{})}),e(H,{path:"/teacher-trash",element:e(Ue,{})}),e(H,{path:"/recap",element:e($e,{})}),e(H,{path:"/detail",element:e(Fe,{})})]})]})})]})]})}const Je=new Ne;ve.createRoot(document.getElementById("root")).render(e(ye,{client:Je,children:e(_e,{children:e(Ge,{})})}));
